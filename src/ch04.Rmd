---
title: "Chapter 4"
author: "Matt Emery"
date: "October 22, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(rethinking)
library(tidyverse)
```

**4E1.** In the model definition below, which line is the likelihood?

$$y_i ∼ Normal(μ, σ)$$
$$μ ∼ Normal(0, 10)$$

$$σ ∼ Uniform(0, 10)$$
$y_i ∼Normal(\mu, \sigma)$ is the likelihood.

**4E2.** In the model definition just above, how many parameters are in the posterior distribution?

There are two paramaters in the posterior distribution: $\mu$ and $\sigma$.

**4E3.** Using the model definition above, write down the appropriate form of Bayes’ theorem that
includes the proper likelihood and priors.

$$p(\mu,\sigma|y) = \frac{N(y|\mu,\sigma)N(\mu|0, 10)Unif(\sigma|0,10)}{\int\int\ N(y|\mu,\sigma)N(\mu|0, 10)Unif(\sigma|0,10)d\mu d\sigma}$$

**4E4.** In the model definition below, which line is the linear model?
$$y_i ∼ Normal(μ, σ)$$
$$μ_i = α + βx_i$$
$$ α ∼ Normal(0, 10)$$
$$β ∼ Normal(0, 1)$$
$$σ ∼ Uniform(0, 10)$$
Answer: $μ_i = α + βx_i$

**4E5.** In the model definition just above, how many parameters are in the posterior distribution?

Three: $\alpha$, $\beta$ and $\sigma$

## Medium.

**4M1.** For the model definition below, simulate observed heights from the prior (not the posterior).

$$y_i ∼ Normal(μ, σ)$$
$$μ ∼ Normal(0, 10)$$
$$σ ∼ Uniform(0, 10)$$

```{r}
prior <- rnorm(1000, rnorm(1000, 0, 10), runif(1000, 0, 10))
sample(prior, 100)
```

**4M2.** Translate the model just above into a map formula.

```{r}
alist(
  y ~ dnorm(mu, sigma),
  mu ~ dnorm(0, 10),
  sigma ~ dunif(0, 10)
)
```


**4M3.** Translate the map model formula below into a mathematical model definition.

```{r}
flist <- alist(
  y ~ dnorm( mu , sigma ),
  mu <- a + b*x,
  a ~ dnorm( 0 , 50 ),
  b ~ dunif( 0 , 10 ),
  sigma ~ dunif( 0 , 50 )
)
```

$$
\begin{eqnarray}
  y_i \sim N(\mu, \sigma) \\
  \mu = a + bx_i \\
  a \sim N(0, 50) \\
  b \sim Unif(0, 10) \\
  \sigma \sim Unif(0, 50)
\end{eqnarray}
$$

**4M4.** A sample of students is measured for height each year for 3 years. After the third year, you want
to fit a linear regression predicting height using year as a predictor. Write down the mathematical
model definition for this regression, using any variable names and priors you choose. Be prepared to
defend your choice of priors.

$$
\begin{aligned}
  y_i \sim N(\mu, \sigma) \\
  \mu = a + bx_i \\
  a \sim N(140, 15) \\
  b \sim Unif(0, 30) \\
  \sigma \sim Unif(0, 50)
\end{aligned}
$$

**4M5.** Now suppose I tell you that the average height in the first year was 120 cm and that every
student got taller each year. Does this information lead you to change your choice of priors? How?

Assuming that the first year means that $x_i = 1$, then my new prior would be: 
$$a \sim N(105, 15)$$
This is 120 - the center of the uniform distribution. $b$ doesn't change because I already accounted for non-negative growth.

**NOTE**: The answer guide seems to suggest that nothing should be changed because the data is now influencing the prior.

**4M6.** Now suppose I tell you that the variance among heights for students of the same age is never
more than 64cm. How does this lead you to revise your priors?

With the same note as before, I would recommend changing the prior to:

$$\sigma \sim Unif(0, 64)$$